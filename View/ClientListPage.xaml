<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="developer_evaluation_mvvm_di.View.ClientListPage"
             xmlns:dg="clr-namespace:Maui.DataGrid;assembly=Maui.DataGrid"
             xmlns:model="clr-namespace:developer_evaluation_mvvm_di.Model"
             xmlns:viewmodel="clr-namespace:developer_evaluation_mvvm_di.ViewModel"             
             x:DataType="viewmodel:ClientListViewModel"
             Title="{Binding Title}">

    <ContentPage.Resources>
        <Color x:Key="txtColor">Black</Color>
        <Color x:Key="bgColor">lightcyan</Color>

        <Style TargetType="Label">
            <Setter Property="TextColor" Value="{DynamicResource txtColor}" />
            <Setter Property="BackgroundColor" Value="{DynamicResource bgColor}" />
        </Style>
    </ContentPage.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="8*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="1" RowDefinitions="70, 50, *">

            <Button Grid.Row="0"
                Text="Add Client"
                WidthRequest="200"
                Margin="5"
                BackgroundColor="LightCyan"
                Command="{Binding AddClientCommand}">
                <Button.ImageSource>
                    <FontImageSource FontFamily="FAS" Color="Black" Glyph="&#xf067;" Size="18" />
                </Button.ImageSource>
            </Button>

            <Grid Grid.Row="1" BackgroundColor="LightCyan" ColumnDefinitions="1*, 2*, 2*, 1*, 3*, 0.8*, 0.8*">
                <Label Grid.Column="0" Text="ID" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"/>
                <Label Grid.Column="1" Text="Name" FontAttributes="Bold" VerticalOptions="Center"/>
                <Label Grid.Column="2" Text="LastName" FontAttributes="Bold" VerticalOptions="Center"/>
                <Label Grid.Column="3" Text="Age" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"/>
                <Label Grid.Column="4" Text="Address" FontAttributes="Bold" VerticalOptions="Center"/>
            </Grid>

            <CollectionView Grid.Row="2" 
                            ItemsSource="{Binding Clients}"
                            SelectionMode="Single"
                            x:Name="ClientsCollection">

                <CollectionView.EmptyView>
                    <Label Text="No clients were registered!"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       FontSize="20"
                       FontAttributes="Bold"
                       Padding="50" />
                </CollectionView.EmptyView>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="model:Client">
                        <Grid ColumnDefinitions="1*, 2*, 2*, 1*, 3*, 0.8*, 0.8*" Padding="5"
                              RowDefinitions="auto"
                              BackgroundColor="LightCyan">
                            <Label Grid.Column="0" BackgroundColor="Transparent" Text="{Binding ID}" VerticalOptions="Center" HorizontalOptions="Center"/>
                            <Label Grid.Column="1" BackgroundColor="Transparent" Text="{Binding Name}" VerticalOptions="Center"/>
                            <Label Grid.Column="2" BackgroundColor="Transparent" Text="{Binding LastName}" VerticalOptions="Center"/>
                            <Label Grid.Column="3" BackgroundColor="Transparent" Text="{Binding Age}" VerticalOptions="Center" HorizontalOptions="Center"/>
                            <Label Grid.Column="4" BackgroundColor="Transparent" Text="{Binding Address}" VerticalOptions="Center"/>

                            <ImageButton Grid.Column="5"
                                     BackgroundColor="LightCyan"
                                     Command="{Binding Source={x:Reference ClientsCollection}, Path=BindingContext.UpdateClientCommand}"
                                     CommandParameter="{Binding .}">
                                <ImageButton.Source>
                                    <FontImageSource FontFamily="FAS" Color="Black" Glyph="&#xf044;" Size="18" />
                                </ImageButton.Source>
                            </ImageButton>

                            <ImageButton Grid.Column="6"
                                     BackgroundColor="LightCyan"
                                     Command="{Binding Source={x:Reference ClientsCollection}, Path=BindingContext.DeleteClientCommand}"
                                     CommandParameter="{Binding .}">
                                <ImageButton.Source>
                                    <FontImageSource FontFamily="FAS" Color="Black" Glyph="&#xf1f8;" Size="18" />
                                </ImageButton.Source>
                            </ImageButton>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>
    </Grid>



</ContentPage>